<!DOCTYPE html>
<html >
   <head>
      <meta charset="UTF-8">
      <title>Customer Details Entry Form</title>
      <link rel='stylesheet prefetch' href='http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css'>
      <link rel='stylesheet prefetch' href='http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css'>
      <link rel='stylesheet prefetch' href='http://cdnjs.cloudflare.com/ajax/libs/jquery.bootstrapvalidator/0.5.0/css/bootstrapValidator.min.css'>
      <script type="text/javascript" src="vendor/jquery/jquery.min.js"></script>
      <script type="text/javascript" src="vendor/bootstrap/js/bootstrap.min.js"></script>
      <script type="text/javascript" src="dist/js/bootstrapValidator.js"></script>
      <script type="text/javascript" src="lib/jquery-ui.js"></script>
      <script src="lib/bootstrap/js/bootstrap-datepicker.js"></script>
      <link rel="stylesheet" type="text/css" href="lib/jquery-ui.css">
      <link rel="stylesheet" href="css/style.css">
   </head>
   <body>
      <div class="container">
         <form class="well form-horizontal" action=" " method="post"  id="new_customer_details" data-toggle="validator">
            <fieldset>
               <!-- Form Name -->
               <legend>Enter Your Details</legend>
               <!-- Text input-->
               <div class="form-group">
                  <label class="col-md-4 control-label">First Name</label>  
                  <div class="col-md-4 inputGroupContainer">
                     <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                        <input  name="firstName" placeholder="First Name" class="form-control"  type="text">
                     </div>
                  </div>
               </div>
               <!-- Text input-->
               <div class="form-group">
                  <label class="col-md-4 control-label" >Last Name</label> 
                  <div class="col-md-4 inputGroupContainer">
                     <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                        <input name="lastName" placeholder="Last Name" class="form-control"  type="text">
                     </div>
                  </div>
               </div>
               <div class="form-group">
                  <label class="col-md-4 control-label">Gender</label>
                  <div class="col-md-4 selectContainer">
                     <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-list"></i></span>
                        <select name="gender" class="form-control selectpicker" >
                           <option value=" " >Please select your Gender</option>
                           <option>FEMALE</option>
                           <option>MALE</option>
                           <option>OTHER</option>
                        </select>
                     </div>
                  </div>
               </div>
               <!-- Text input-->
               <div class="form-group">
                  <label class="col-md-4 control-label">DOB</label>  
                  <div class="col-md-4 inputGroupContainer">
                     <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                        <input name="dob" id="datepicker" placeholder="YYYY-MM-DD" class="form-control"  type="text">
                     </div>
                  </div>
               </div>
               <div class="form-group">
                  <label class="col-md-4 control-label">Address</label>  
                  <div class="col-md-4 inputGroupContainer">
                     <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-home"></i></span>
                        <input name="address" placeholder="Address" class="form-control" type="text">
                     </div>
                  </div>
               </div>
               <!-- Text input-->
               <div class="form-group">
                  <label class="col-md-4 control-label">City</label>  
                  <div class="col-md-4 inputGroupContainer">
                     <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-home"></i></span>
                        <input name="city" placeholder="City" class="form-control"  type="text">
                     </div>
                  </div>
               </div>
               <!-- Select Basic -->
               <div class="form-group">
                  <label class="col-md-4 control-label">State</label>
                  <div class="col-md-4 selectContainer">
                     <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-list"></i></span>
                        <select name="state" class="form-control selectpicker" >
                           <option value=" " >Please select your state</option>
                           <option>Andhra Pradesh (AP)</option>
                           <option>Arunachal Pradesh (AR)</option>
                           <option>Assam (AS)</option>
                           <option>Bihar (BR)</option>
                           <option>Chhattisgarh (CG)</option>
                           <option>Goa (GA)</option>
                           <option>Gujarat (GJ)</option>
                           <option>Haryana (HR)</option>
                           <option>Himachal Pradesh (HP)</option>
                           <option>Jammu and Kashmir (JK)</option>
                           <option>Jharkhand (JH)</option>
                           <option>Karnataka (KA)</option>
                           <option>Kerala (KL)</option>
                           <option>Madhya Pradesh (MP)</option>
                           <option>Maharashtra (MH)</option>
                           <option>Manipur (MN)</option>
                           <option>Meghalaya (ML)</option>
                           <option>Mizoram (MZ)</option>
                           <option>Nagaland (NL)</option>
                           <option>Odisha(OR)</option>
                           <option>Punjab (PB)</option>
                           <option>Rajasthan (RJ)</option>
                           <option>Sikkim (SK)</option>
                           <option>Tamil Nadu (TN)</option>
                           <option>Tripura (TR)</option>
                           <option>Uttar Pradesh (UP)</option>
                           <option>Uttarakhand (UK)</option>
                           <option>West Bengal (WB)</option>
                        </select>
                     </div>
                  </div>
               </div>
               <!-- Text input-->
               <div class="form-group">
                  <label class="col-md-4 control-label">Zip Code</label>  
                  <div class="col-md-4 inputGroupContainer">
                     <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-home"></i></span>
                        <input name="zip" placeholder="Zip Code" class="form-control"  type="text">
                     </div>
                  </div>
               </div>
               <div class="form-group">
                  <label class="col-md-4 control-label">E-Mail</label>  
                  <div class="col-md-4 inputGroupContainer">
                     <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-envelope"></i></span>
                        <input name="email" placeholder="E-Mail Address" class="form-control"  type="text">
                     </div>
                  </div>
               </div>
               <!-- Text input-->
               <div class="form-group">
                  <label class="col-md-4 control-label">Phone #</label>  
                  <div class="col-md-4 inputGroupContainer">
                     <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-earphone"></i></span>
                        <span class="input-group-addon"><input type="button" value="+91" disabled/></span>
                        <input name="phone" placeholder="9999999999" class="form-control" type="text">
                     </div>
                  </div>
               </div>
               <div class="form-group">
                  <label class="col-md-4 control-label">Fax #</label>  
                  <div class="col-md-4 inputGroupContainer">
                     <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-print"></i></span>
                        <input name="fax" placeholder="12345" class="form-control" type="text">
                     </div>
                  </div>
               </div>
               <!-- Success message -->
               <div class="alert alert-success" role="alert" id="success_message">Success <i class="glyphicon glyphicon-thumbs-up"></i> Thank you for registering as a customer with ABC Bank. Welcome!</div>
               <div class="alert alert-danger" role="alert" id="failure_message">Failure <i class="glyphicon glyphicon-thumbs-down"></i> Adding the account failed, check the customer email ID provided, it has to be an email Id of an existing customer. You can add a new customer <a href="addCustomer.html">here</a></div>
               <div class="alert alert-info" role="alert" id="message"></div>
               <!-- Button -->
               <div class="form-group">
                  <label class="col-md-4 control-label"></label>
                  <div class="col-md-4">
                     <button type="submit" class="btn btn-warning" id="submit1">Send <span class="glyphicon glyphicon-send"></span></button>
                  </div>
               </div>
               <div class="form-group">
                  <label class="col-md-4 control-label"></label>
                  <div class="col-md-4">
                     <button type="button" class="btn btn-info" id="resetBtn">Reset form</button>
                  </div>
               </div>
            </fieldset>
         </form>
      </div>
      </div><!-- /.container -->
      <footer>
         <a href="index.html">
            <h4>Home</h4>
         </a>
      </footer>
      <script type="text/javascript">
         $(document).ready(function() {
          $('#datepicker').datepicker({
            format: "yyyy-mm-dd",
            maxDate: (new Date()).getDate()
          });  
         
          $('#new_customer_details')
          .bootstrapValidator({
            message: 'This value is not valid',
                              //live: 'submitted',
                              feedbackIcons: {
                                valid: 'glyphicon glyphicon-ok',
                                invalid: 'glyphicon glyphicon-remove',
                                validating: 'glyphicon glyphicon-refresh'
                              },
                              fields: {
                                fname: {
                                  validators: {
                                    stringLength: {
                                      min: 2,
                                    },
                                    notEmpty: {
                                      message: 'Please supply your first name'
                                    }
                                  }
                                },
                                gender: {
                                  validators: {
                                    notEmpty: {
                                      message: 'Please select your gender'
                                    }
                                  }
                                },
                                dob: {
                                  validators: {
                                    notEmpty: {
                                      message: 'Please enter your dob'
                                    },
                                    date: {
                                      format: 'YYYY-MM-DD',
                                      message: 'The value is not a valid date'
                                    }
                                  }
                                },
         
                                address: {
                                  validators: {
                                   stringLength: {
                                    min: 8,
                                  },
                                  notEmpty: {
                                    message: 'Please supply your street address, it has to be atleast 8 characters'
                                  }
                                }
                              },
                              city: {
                                validators: {
                                 stringLength: {
                                  min: 4,
                                },
                                notEmpty: {
                                  message: 'Please supply your city, it has to be atleast 4 characters'
                                }
                              }
                            },
                            state: {
                              validators: {
                                notEmpty: {
                                  message: 'Please select your state'
                                }
                              }
                            },
                            zip: {
                              validators: {
         
                                notEmpty: {
                                  message: 'Please supply your zip code'
                                },
                                regexp: {
                                  regexp: /^\d{6}$/,
                                  message: 'The Indian zipcode must contain exactly 6 digits'
                                }
                              }
                            },email: {
                              validators: {
                                notEmpty: {
                                  message: 'Please supply your email address'
                                },
                                emailAddress: {
                                  message: 'Please supply a valid email address'
                                }
                              }
                            },
                            phone: {
                              validators: {
                                regexp: {
                                  regexp: /^[789]\d{9}$/,
                                  message: 'Example of a valid phone number 9876543210'
                                }
                              }
                            },
                            fax: {
                              stringLength: {
                                max: 15,
                              },
                              regexp: {
                                regexp: /[0-9 ]+/,
                                message: 'Fax can be max 15 characters,only numbers and spaces'
                              }
                            }
                          }
                        })
         .on('success.form.bv', function(e) {
                              // Prevent submit form
                              e.preventDefault();
         
                              var $form     = $(e.target),
                              validator = $form.data('bootstrapValidator');
         
                              var json = {};
                              $("#new_customer_details").serializeArray().map(function(item) {
                               json[item.name] = item.value;
                             });
                              console.log(json);
                              
                              //sending json to server
                              $.ajax({
                               type: "POST",
                               url: "http://localhost:8080/abcbank-rest/rest/service/addCustomer",
                               data: JSON.stringify(json),
                               contentType: "application/json; charset=utf-8",
                               dataType: "json",
                               success: function(data){handleServerResponse(data)},
                               failure: function(errMsg) {
                                 alert("Failed");
                               }
                             });
         
                              
         
         
                            });
         
         
             $('#resetBtn').click(function() {
                 $('#new_customer_details').data('bootstrapValidator').resetForm(true);
             });
         
         
         
             function handleServerResponse(response){
               console.log(response);
               if(response['status']=='SUCCESS'){
                       $('#success_message').slideDown({ opacity: "show" }, "slow");
               }else{
                               $('#failure_message').slideDown({ opacity: "show" }, "slow");
         
               }    
               $('message').text(response['message']);
         
             }
             
         });
         
         
      </script>
   </body>
</html>
